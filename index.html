<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Basic Education Access in Malaysia</title>

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;600&family=PT+Serif:wght@700&display=swap" rel="stylesheet">

  <!-- Pure.css -->
  <link rel="stylesheet" href="https://unpkg.com/purecss@2.0.3/build/pure-min.css" 
        integrity="sha384-cg6SkqEOCV1NbJoCu11+bm0NvBRc8IYLRGXkmNrqUBfTjmMYwNKPWBTIKyw9mHNJ" 
        crossorigin="anonymous">

  <!-- Vega libraries -->
  <script src="https://cdn.jsdelivr.net/npm/vega@5"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-lite@5"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script>

  <!-- Your styles -->
  <link rel="stylesheet" href="css/styles.css" />
</head>






<body>
  <div class="page">
    
    <!-- Page Header Section -->
    <div class="page-header">
      <h1>Basic Education Access Across Malaysia</h1>
      <p class="subtitle">Interactive multiple views: Select Stage, Year & State once and explore across coordinated charts</p>
      

    </div>

    <!-- Custom Filters -->
    <div class="custom-filters">

      <div class="filter-group">
        <label for="stage-select">Stage:</label>
        <select id="stage-select">
          <option value="primary" selected>primary</option>
          <option value="secondary">secondary</option>
        </select>
      </div>
      
      <div class="filter-group">
        <label for="year-select">Year:</label>
        <select id="year-select">
          <option value="2017">2017</option>
          <option value="2018">2018</option>
          <option value="2019">2019</option>
          <option value="2020">2020</option>
          <option value="2021">2021</option>
          <option value="2022" selected>2022</option>
        </select>
      </div>
      
      <div class="filter-group">
        <label for="state-select">State:</label>
        <select id="state-select">
          <option value="Johor" selected>Johor</option>
          <option value="Kedah">Kedah</option>
          <option value="Kelantan">Kelantan</option>
          <option value="Melaka">Melaka</option>
          <option value="Negeri Sembilan">Negeri Sembilan</option>
          <option value="Pahang">Pahang</option>
          <option value="Perak">Perak</option>
          <option value="Perlis">Perlis</option>
          <option value="Pulau Pinang">Pulau Pinang</option>
          <option value="Sabah">Sabah</option>
          <option value="Sarawak">Sarawak</option>
          <option value="Selangor">Selangor</option>
          <option value="Terengganu">Terengganu</option>
          <option value="Kuala Lumpur">Kuala Lumpur</option>
          <option value="Labuan">Labuan</option>
          <option value="Putrajaya">Putrajaya</option>
        </select>
      </div>

      <div class="filter-group">
        <label for="zoom">Zoom:</label>
        <input id="zoom" type="range" min="600" max="5000" step="50" value="1850">
      </div>

      <div class="filter-group">
        <label for="center">Map centre:</label>
        <select id="center">
          <option value='[102,4.5]'>West Malaysia</option>
          <option value='[114.5,2.0]'>East Malaysia</option>
          <option value='[109.3,4.2]' selected>Whole Malaysia</option>
        </select>
      </div>

    </div>

    <!-- Dashboard Visualization -->
    <div id="dashboard" class="vis-container"></div>

    <!-- Footer -->
    <div class="small-font">

    <p class="meta"><br>Author: Yuan Kah Mun · Last updated: 19 October 2025</p>

    <p class="meta"><br>Data Source:</p>

    <p class="meta">
    1. OpenDOSM —
    <a href="https://open.dosm.gov.my/data-catalogue/schools_district?state=kedah&district=all-districts&stage=secondary&type=sekolah-menengah-kerajaan&visual=table" target="_blank">
        https://open.dosm.gov.my/data-catalogue/schools_district?state=kedah&district=all-districts&stage=secondary&type=sekolah-menengah-kerajaan&visual=table
    </a>
    </p>

    <p class="meta">
    2. OpenDOSM —
    <a href="https://open.dosm.gov.my/data-catalogue/enrolment_school_district?state=malaysia&district=all-districts&stage=post-secondary&sex=both&visual=table" target="_blank">
        https://open.dosm.gov.my/data-catalogue/enrolment_school_district?state=malaysia&district=all-districts&stage=post-secondary&sex=both&visual=table
    </a>
    </p>

    <p class="meta">
    3. simplemaps —
    <a href="https://simplemaps.com/data/my-cities" target="_blank">
        https://simplemaps.com/data/my-cities
    </a>
    </p>
    

    </div>

  </div>

<script>
  // We'll keep a single embed + a single set of listeners
  vegaEmbed("#dashboard", "js/dashboard_basic_ed.vg.json", { actions: false, renderer: "svg" })
    .then(async ({ view }) => {
      // HTML controls
      const stageEl  = document.getElementById('stage-select');
      const yearEl   = document.getElementById('year-select');
      const stateEl  = document.getElementById('state-select');
      const zoomEl   = document.getElementById('zoom');
      const centerEl = document.getElementById('center');

      // Helpers to update signals
      const setZoom   = v => view.signal('Zoom', +v);
      const setCenter = v => view.signal('CenterTo', JSON.parse(v));

      async function syncAll() {
        const y = parseInt(yearEl.value, 10);
        const k = Math.random(); // forces recompute where you use Rekey

        await view
          .signal('StageSel', stageEl.value)
          .signal('YearSel',  y)
          .signal('StateSel', stateEl.value)
          .signal('Rekey',    k)
          .signal('Zoom',     +zoomEl.value)          // NEW
          .signal('CenterTo', JSON.parse(centerEl.value)) // NEW
          .runAsync();
      }

      // Initial sync
      await syncAll();

      // Events
      stageEl.addEventListener('change', syncAll);
      yearEl .addEventListener('change', syncAll);
      stateEl.addEventListener('change', syncAll);

      // Zoom reacts as you drag; change → when you release
      zoomEl .addEventListener('input',  () => { setZoom(zoomEl.value); view.run(); });
      zoomEl .addEventListener('change', () => { setZoom(zoomEl.value); view.run(); });

      centerEl.addEventListener('change', () => { setCenter(centerEl.value); view.run(); });
    });
</script>


</body>
</html>